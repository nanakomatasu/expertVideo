{"version":3,"file":"use-search-box.js","sources":["uni_modules/tuniaoui-vue3/components/search-box/src/composables/use-search-box.ts"],"sourcesContent":["import { nextTick, ref, watch } from 'vue'\nimport { debounce, throttle } from '../../../../libs/lodash'\nimport { CHANGE_EVENT, UPDATE_MODEL_EVENT } from '../../../../constants'\n\nimport type { SetupContext } from 'vue'\nimport type { SearchBoxEmits, SearchBoxProps } from '../search-box'\n\nexport const useSearchBox = (\n  props: SearchBoxProps,\n  emits: SetupContext<SearchBoxEmits>['emit']\n) => {\n  // 是否显示placeholder\n  const showPlaceholder = ref<boolean>(!props.modelValue)\n\n  // 输入框的值\n  const inputValue = ref<string>(props.modelValue)\n  watch(\n    () => props.modelValue,\n    (val) => {\n      if (props.modelValue === inputValue.value) return\n      inputValue.value = val\n      showPlaceholder.value = !val\n    }\n  )\n  // 输入框聚焦\n  const inputFocus = ref<boolean>(false)\n  if (props.focus) {\n    showPlaceholder.value = false\n    nextTick(() => {\n      inputFocus.value = true\n    })\n  }\n\n  // searchBox点击事件\n  const searchBoxClickEvent = () => {\n    emits('click')\n    if (props.disabled) return\n    showPlaceholder.value = false\n    inputFocus.value = true\n  }\n\n  // 输入框获取焦点事件\n  const inputFocusEvent = () => {\n    emits('focus')\n  }\n\n  // 输入框失去焦点事件\n  const inputBlurEvent = () => {\n    showPlaceholder.value = !inputValue.value\n    inputFocus.value = false\n    emits('blur')\n  }\n\n  // 输入框输入事件\n  const inputHandle = () => {\n    emits(UPDATE_MODEL_EVENT, inputValue.value)\n\n    nextTick(() => {\n      emits(CHANGE_EVENT, inputValue.value)\n      emits('input', inputValue.value)\n    })\n  }\n  const inputValueEvent = props.throllte\n    ? throttle(inputHandle, props.throllteTime)\n    : inputHandle\n\n  // 清除按钮点击事件\n  const clearClickEvent = () => {\n    inputValue.value = ''\n    emits(UPDATE_MODEL_EVENT, '')\n\n    nextTick(() => {\n      inputFocus.value = true\n      emits(CHANGE_EVENT, '')\n      emits('clear')\n    })\n  }\n\n  // 点击search按钮事件\n  const searchBtnClickEvent = debounce(() => {\n    if (props.disabled) return\n    emits('search', inputValue.value)\n  }, 250)\n\n  return {\n    showPlaceholder,\n    inputValue,\n    inputFocus,\n    searchBoxClickEvent,\n    inputFocusEvent,\n    inputBlurEvent,\n    inputValueEvent,\n    clearClickEvent,\n    searchBtnClickEvent,\n  }\n}\n"],"names":["ref","watch","nextTick","UPDATE_MODEL_EVENT","CHANGE_EVENT","throttle","debounce"],"mappings":";;;;;;AAOa,MAAA,eAAe,CAC1B,OACA,UACG;AAEH,QAAM,kBAAkBA,cAAA,IAAa,CAAC,MAAM,UAAU;AAGhD,QAAA,aAAaA,cAAAA,IAAY,MAAM,UAAU;AAC/CC,gBAAA;AAAA,IACE,MAAM,MAAM;AAAA,IACZ,CAAC,QAAQ;AACH,UAAA,MAAM,eAAe,WAAW;AAAO;AAC3C,iBAAW,QAAQ;AACnB,sBAAgB,QAAQ,CAAC;AAAA,IAC3B;AAAA,EAAA;AAGI,QAAA,aAAaD,kBAAa,KAAK;AACrC,MAAI,MAAM,OAAO;AACf,oBAAgB,QAAQ;AACxBE,kBAAAA,WAAS,MAAM;AACb,iBAAW,QAAQ;AAAA,IAAA,CACpB;AAAA,EACH;AAGA,QAAM,sBAAsB,MAAM;AAChC,UAAM,OAAO;AACb,QAAI,MAAM;AAAU;AACpB,oBAAgB,QAAQ;AACxB,eAAW,QAAQ;AAAA,EAAA;AAIrB,QAAM,kBAAkB,MAAM;AAC5B,UAAM,OAAO;AAAA,EAAA;AAIf,QAAM,iBAAiB,MAAM;AACX,oBAAA,QAAQ,CAAC,WAAW;AACpC,eAAW,QAAQ;AACnB,UAAM,MAAM;AAAA,EAAA;AAId,QAAM,cAAc,MAAM;AAClB,UAAAC,yCAAA,oBAAoB,WAAW,KAAK;AAE1CD,kBAAAA,WAAS,MAAM;AACP,YAAAE,yCAAA,cAAc,WAAW,KAAK;AAC9B,YAAA,SAAS,WAAW,KAAK;AAAA,IAAA,CAChC;AAAA,EAAA;AAEH,QAAM,kBAAkB,MAAM,WAC1BC,8CAAAA,SAAS,aAAa,MAAM,YAAY,IACxC;AAGJ,QAAM,kBAAkB,MAAM;AAC5B,eAAW,QAAQ;AACnB,UAAMF,yCAAAA,oBAAoB,EAAE;AAE5BD,kBAAAA,WAAS,MAAM;AACb,iBAAW,QAAQ;AACnB,YAAME,yCAAAA,cAAc,EAAE;AACtB,YAAM,OAAO;AAAA,IAAA,CACd;AAAA,EAAA;AAIG,QAAA,sBAAsBE,8CAAAA,SAAS,MAAM;AACzC,QAAI,MAAM;AAAU;AACd,UAAA,UAAU,WAAW,KAAK;AAAA,KAC/B,GAAG;AAEC,SAAA;AAAA,IACL;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,IACA;AAAA,EAAA;AAEJ;;"}