{"version":3,"file":"use-search-box.js","sources":["uni_modules/tuniaoui-vue3/components/search-box/src/composables/use-search-box.ts"],"sourcesContent":["import { nextTick, ref, watch } from 'vue'\nimport { debounce, throttle } from '../../../../libs/lodash'\nimport { CHANGE_EVENT, UPDATE_MODEL_EVENT } from '../../../../constants'\n\nimport type { SetupContext } from 'vue'\nimport type { SearchBoxEmits, SearchBoxProps } from '../search-box'\n\nexport const useSearchBox = (\n  props: SearchBoxProps,\n  emits: SetupContext<SearchBoxEmits>['emit']\n) => {\n  // 是否显示placeholder\n  const showPlaceholder = ref<boolean>(!props.modelValue)\n\n  // 输入框的值\n  const inputValue = ref<string>(props.modelValue)\n  watch(\n    () => props.modelValue,\n    (val) => {\n      if (props.modelValue === inputValue.value) return\n      inputValue.value = val\n      showPlaceholder.value = !val\n    }\n  )\n  // 输入框聚焦\n  const inputFocus = ref<boolean>(false)\n  if (props.focus) {\n    showPlaceholder.value = false\n    nextTick(() => {\n      inputFocus.value = true\n    })\n  }\n\n  // searchBox点击事件\n  const searchBoxClickEvent = () => {\n    emits('click')\n    if (props.disabled) return\n    showPlaceholder.value = false\n    inputFocus.value = true\n  }\n\n  // 输入框获取焦点事件\n  const inputFocusEvent = () => {\n    emits('focus')\n  }\n\n  // 输入框失去焦点事件\n  const inputBlurEvent = () => {\n    showPlaceholder.value = !inputValue.value\n    inputFocus.value = false\n    emits('blur')\n  }\n\n  // 输入框输入事件\n  const inputHandle = () => {\n    emits(UPDATE_MODEL_EVENT, inputValue.value)\n\n    nextTick(() => {\n      emits(CHANGE_EVENT, inputValue.value)\n      emits('input', inputValue.value)\n    })\n  }\n  const inputValueEvent = props.throllte\n    ? throttle(inputHandle, props.throllteTime)\n    : inputHandle\n\n  // 清除按钮点击事件\n  const clearClickEvent = () => {\n    inputValue.value = ''\n    emits(UPDATE_MODEL_EVENT, '')\n\n    nextTick(() => {\n      inputFocus.value = true\n      emits(CHANGE_EVENT, '')\n      emits('clear')\n    })\n  }\n\n  // 点击search按钮事件\n  const searchBtnClickEvent = debounce(() => {\n    if (props.disabled) return\n    emits('search', inputValue.value)\n  }, 250)\n\n  return {\n    showPlaceholder,\n    inputValue,\n    inputFocus,\n    searchBoxClickEvent,\n    inputFocusEvent,\n    inputBlurEvent,\n    inputValueEvent,\n    clearClickEvent,\n    searchBtnClickEvent,\n  }\n}\n"],"names":["useSearchBox","props","emits","showPlaceholder","ref","inputValue","watch","val","inputFocus","nextTick","searchBoxClickEvent","inputFocusEvent","inputBlurEvent","inputHandle","UPDATE_MODEL_EVENT","CHANGE_EVENT","inputValueEvent","throttle","clearClickEvent","searchBtnClickEvent","debounce"],"mappings":"2QAOaA,EAAe,CAC1BC,EACAC,IACG,CAEH,MAAMC,EAAkBC,EAAA,IAAa,CAACH,EAAM,UAAU,EAGhDI,EAAaD,EAAAA,IAAYH,EAAM,UAAU,EAC/CK,EAAA,MACE,IAAML,EAAM,WACXM,GAAQ,CACHN,EAAM,aAAeI,EAAW,QACpCA,EAAW,MAAQE,EACnBJ,EAAgB,MAAQ,CAACI,EAC3B,CAAA,EAGI,MAAAC,EAAaJ,MAAa,EAAK,EACjCH,EAAM,QACRE,EAAgB,MAAQ,GACxBM,EAAAA,WAAS,IAAM,CACbD,EAAW,MAAQ,EAAA,CACpB,GAIH,MAAME,EAAsB,IAAM,CAChCR,EAAM,OAAO,EACT,CAAAD,EAAM,WACVE,EAAgB,MAAQ,GACxBK,EAAW,MAAQ,GAAA,EAIfG,EAAkB,IAAM,CAC5BT,EAAM,OAAO,CAAA,EAITU,EAAiB,IAAM,CACXT,EAAA,MAAQ,CAACE,EAAW,MACpCG,EAAW,MAAQ,GACnBN,EAAM,MAAM,CAAA,EAIRW,EAAc,IAAM,CAClBX,EAAAY,EAAA,mBAAoBT,EAAW,KAAK,EAE1CI,EAAAA,WAAS,IAAM,CACPP,EAAAa,EAAA,aAAcV,EAAW,KAAK,EAC9BH,EAAA,QAASG,EAAW,KAAK,CAAA,CAChC,CAAA,EAEGW,EAAkBf,EAAM,SAC1BgB,EAAAA,SAASJ,EAAaZ,EAAM,YAAY,EACxCY,EAGEK,EAAkB,IAAM,CAC5Bb,EAAW,MAAQ,GACnBH,EAAMY,EAAAA,mBAAoB,EAAE,EAE5BL,EAAAA,WAAS,IAAM,CACbD,EAAW,MAAQ,GACnBN,EAAMa,EAAAA,aAAc,EAAE,EACtBb,EAAM,OAAO,CAAA,CACd,CAAA,EAIGiB,EAAsBC,EAAAA,SAAS,IAAM,CACrCnB,EAAM,UACJC,EAAA,SAAUG,EAAW,KAAK,GAC/B,GAAG,EAEC,MAAA,CACL,gBAAAF,EACA,WAAAE,EACA,WAAAG,EACA,oBAAAE,EACA,gBAAAC,EACA,eAAAC,EACA,gBAAAI,EACA,gBAAAE,EACA,oBAAAC,CAAA,CAEJ"}