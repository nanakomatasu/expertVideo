{"version":3,"file":"inviteFriends.js","sources":["pages/mineFunc/inviteFriends.vue","../../HbuilderX/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXNcbWluZUZ1bmNcaW52aXRlRnJpZW5kcy52dWU"],"sourcesContent":["<template>\r\n\t<view class=\"navigation-bar navigation-bar-background\">\r\n\t\t<view class=\"navgation-bar-content text-color\">\r\n\t\t\t<view style=\"position: absolute; left: 32rpx; top: 11rpx;\"> <uv-icon name=\"arrow-left\" color=\"#fff\"\r\n\t\t\t\t\t@click=\"backPages\"></uv-icon></view>\r\n\t\t\t我的海报\r\n\t\t</view>\r\n\t</view>\r\n\t<view class=\"invite-cover center-box\">\r\n\t\t<image :src=\"SERVERTAPI + inviteImage\" mode=\"aspectFit\" lazy-load></image>\r\n\t</view>\r\n\t<view class=\"save-btn center-box\" @click=\"posterSure\">保存图片</view>\r\n</template>\r\n\r\n<script setup>\r\n\timport {\r\n\t\tref\r\n\t} from 'vue';\r\n\timport {\r\n\t\tonLoad\r\n\t} from '@dcloudio/uni-app'\r\n\timport {\r\n\t\tgetInviterCode\r\n\t} from '../../request/api';\r\n\timport {\r\n\t\tuseUserStore\r\n\t} from '../../store/user';\r\n\timport {\r\n\t\tSERVERTAPI\r\n\t} from '../../config';\r\n\tconst inviteImage = ref(\"\")\r\n\tconst userStore = useUserStore()\r\n\tonLoad(() => {\r\n\t\tgetUserInfo()\r\n\t})\r\n\tconst backPages = () => {\r\n\t\tuni.navigateBack()\r\n\t}\r\n\tconst getUserInfo = () => {\r\n\t\tgetInviterCode({\r\n\t\t\tuid: userStore.uid,\r\n\t\t\ttoken: userStore.token\r\n\t\t}).then(res => {\r\n\t\t\tinviteImage.value = res.data\r\n\t\t})\r\n\t}\r\n\tconst posterSure = (item) => {\r\n\t\tuni.downloadFile({\r\n\t\t\turl: SERVERTAPI + inviteImage.value,\r\n\t\t\tsuccess: function(res) {\r\n\t\t\t\tconsole.log(res)\r\n\t\t\t\twx.saveImageToPhotosAlbum({\r\n\t\t\t\t\tfilePath: res.tempFilePath,\r\n\t\t\t\t\tsuccess: function(res) {\r\n\t\t\t\t\t\tconsole.log(res)\r\n\t\t\t\t\t\tconsole.log('success')\r\n\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\ticon: 'success',\r\n\t\t\t\t\t\t\ttitle: '保存成功'\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail: function(res) {\r\n\t\t\t\t\t\tconsole.log(res)\r\n\t\t\t\t\t\tconsole.log('fail')\r\n\t\t\t\t\t\tif (res.errMsg === \"saveImageToPhotosAlbum:fail auth deny\") {\r\n\t\t\t\t\t\t\tconsole.log(\"打开设置窗口\");\r\n\t\t\t\t\t\t\twx.openSetting({\r\n\t\t\t\t\t\t\t\tsuccess(settingdata) {\r\n\t\t\t\t\t\t\t\t\tconsole.log(settingdata)\r\n\t\t\t\t\t\t\t\t\tif (settingdata.authSetting[\r\n\t\t\t\t\t\t\t\t\t\t\t\"scope.writePhotosAlbum\"]) {\r\n\t\t\t\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\t\t\t\ticon: 'success',\r\n\t\t\t\t\t\t\t\t\t\t\ttitle: '保存成功'\r\n\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\tconsole.log(\"获取权限成功，再次点击图片保存到相册\")\r\n\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\tconsole.log(\"获取权限失败\")\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tfail: function() {\r\n\t\t\t\tconsole.log('fail')\r\n\t\t\t}\r\n\t\t})\r\n\t}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n\t.navigation-bar {\r\n\t\toverflow: hidden;\r\n\t\twidth: 100%;\r\n\t\theight: 196rpx;\r\n\r\n\t\t.navgation-bar-content {\r\n\t\t\tposition: relative;\r\n\t\t\tmargin-top: 88rpx;\r\n\t\t\twidth: 100%;\r\n\t\t\theight: 108rpx;\r\n\t\t\ttext-align: center;\r\n\t\t}\r\n\r\n\t\t.text-color {\r\n\t\t\tcolor: #fff;\r\n\t\t}\r\n\t}\r\n\r\n\t.invite-cover {\r\n\t\theight: 70vh;\r\n\t\tmargin-top: 40rpx;\r\n\r\n\t\timage {\r\n\t\t\twidth: 100%;\r\n\t\t\theight: 100%;\r\n\t\t}\r\n\t}\r\n\r\n\t.save-btn {\r\n\t\tmargin-top: 48rpx;\r\n\t\theight: 96rpx;\r\n\t\ttext-align: center;\r\n\t\tline-height: 96rpx;\r\n\t\tborder-radius: 60rpx 60rpx 60rpx 60rpx;\r\n\t\tbackground-color: #FAA82C;\r\n\t\tfont-size: 28rpx;\r\n\t\tcolor: #FFFFFF;\r\n\t}\r\n</style>","import MiniProgramPage from 'D:/work/达人h5/pages/mineFunc/inviteFriends.vue'\nwx.createPage(MiniProgramPage)"],"names":["inviteImage","ref","userStore","useUserStore","onLoad","getUserInfo","backPages","uni","getInviterCode","res","posterSure","item","SERVERTAPI","wx","settingdata","MiniProgramPage"],"mappings":"6TA8BC,MAAMA,EAAcC,EAAG,IAAC,EAAE,EACpBC,EAAYC,EAAAA,aAAc,EAChCC,EAAAA,OAAO,IAAM,CACZC,EAAa,CACf,CAAE,EACD,MAAMC,EAAY,IAAM,CACvBC,EAAAA,MAAI,aAAc,CAClB,EACKF,EAAc,IAAM,CACzBG,iBAAe,CACd,IAAKN,EAAU,IACf,MAAOA,EAAU,KACpB,CAAG,EAAE,KAAKO,GAAO,CACdT,EAAY,MAAQS,EAAI,IAC3B,CAAG,CACD,EACKC,EAAcC,GAAS,CAC5BJ,EAAAA,MAAI,aAAa,CAChB,IAAKK,EAAAA,WAAaZ,EAAY,MAC9B,QAAS,SAASS,EAAK,CACtBF,EAAAA,MAAA,MAAA,MAAA,yCAAYE,CAAG,EACfI,EAAAA,KAAG,uBAAuB,CACzB,SAAUJ,EAAI,aACd,QAAS,SAASA,EAAK,CACtBF,EAAAA,2DAAYE,CAAG,EACfF,EAAAA,2DAAY,SAAS,EACrBA,EAAAA,MAAI,UAAU,CACb,KAAM,UACN,MAAO,MACd,CAAO,CACD,EACD,KAAM,SAASE,EAAK,CACnBF,EAAAA,2DAAYE,CAAG,EACfF,EAAAA,MAAA,MAAA,MAAA,yCAAY,MAAM,EACdE,EAAI,SAAW,0CAClBF,EAAAA,MAAY,MAAA,MAAA,yCAAA,QAAQ,EACpBM,EAAAA,KAAG,YAAY,CACd,QAAQC,EAAa,CACpBP,EAAAA,MAAY,MAAA,MAAA,yCAAAO,CAAW,EACnBA,EAAY,YACd,wBAAwB,GACzBP,EAAAA,MAAI,UAAU,CACb,KAAM,UACN,MAAO,MAClB,CAAW,EACDA,EAAAA,MAAA,MAAA,MAAA,yCAAY,oBAAoB,GAEhCA,EAAAA,2DAAY,QAAQ,CAErB,CACT,CAAQ,EAEF,CACN,CAAK,CACD,EACD,KAAM,UAAW,CAChBA,EAAAA,MAAY,MAAA,MAAA,yCAAA,MAAM,CAClB,CACJ,CAAG,CACD,+GCxFF,GAAG,WAAWQ,CAAe"}