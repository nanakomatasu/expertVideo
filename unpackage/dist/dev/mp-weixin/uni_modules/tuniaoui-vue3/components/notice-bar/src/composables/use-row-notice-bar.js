"use strict";const e=require("../../../../../../common/vendor.js"),T=require("../../../../tokens/notice-bar.js"),g=require("../../../../utils/is-empty.js");require("../../../../libs/lodash/_baseToString.js");const v=require("../../../../utils/rand.js"),V=require("../../../../utils/error.js"),$=require("../../../../hooks/use-selector-query/index.js");require("../../../../hooks/use-z-index/index.js");const k=()=>{const h=e.getCurrentInstance(),t=e.inject(T.noticeBarKey,null),{getSelectorNodeInfo:m}=$.useSelectorQuery(h),s=`trnb-${v.generateId()}`,_=`${s}-text`,y=e.computed(()=>{var n;return(n=t==null?void 0:t.data)!=null&&n.length?t.data.join(" "):""}),q=e.computed(()=>g.isEmptyVariableInDefault(t==null?void 0:t.speed,80));let u=0,o=null;const r=e.ref(null);let i=null;const p=()=>{o=e.index.createAnimation({duration:u,timingFunction:"linear"}),o.translateX(-(l+c)+Number(Math.random()*10)).step({duration:u}),o.translateX(0).step({duration:0}),r.value=o.export()},f=()=>{p(),i=setInterval(()=>{p()},u+80)},I=()=>{o=null,r.value=null,i&&(clearInterval(i),i=null)};e.watch(()=>t==null?void 0:t.play,n=>{n?f():I()});let a=0,l=0,c=0;const d=async()=>{try{const n=await m(`#${s}`),x=await m(`#${_}`);a=0,l=n.width||0,c=x.width||0,u=(l+c)/q.value*1e3,t!=null&&t.play&&(t!=null&&t.autoPlay)&&setTimeout(()=>{f()},50)}catch(n){if(a>10){a=0,V.debugWarn("TnNoticeBar",`获取通知栏容器信息失败: ${n}`);return}a++,setTimeout(()=>{d()},150)}};e.watch(()=>t==null?void 0:t.speed,()=>{I(),d()});const w=()=>{t==null||t.click(0)};return e.onMounted(()=>{e.nextTick$1(()=>{d()})}),{componentId:s,componentTextId:_,data:y,animationData:r,noticeClickEvent:w}};exports.useRowNoticeBar=k;
//# sourceMappingURL=../../../../../../../.sourcemap/mp-weixin/uni_modules/tuniaoui-vue3/components/notice-bar/src/composables/use-row-notice-bar.js.map
