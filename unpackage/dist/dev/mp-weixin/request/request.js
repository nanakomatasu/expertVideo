"use strict";const o=require("../common/vendor.js"),u=require("../config/index.js"),c=require("../store/user.js");c.useUserStore();const d=()=>new Promise(t=>{o.index.showModal({title:"请先去登陆吧",success(a){if(a.confirm)o.index.navigateTo({url:"/pages/account/login"});else return;t()}})}),i=t=>{o.index.showToast({icon:"none",title:t})},l=(t={})=>new Promise((a,n)=>{const s=o.index.getStorageSync("token"),r={"Content-Type":"application/json",...t.header};s&&(r.Authorization=`Bearer ${s}`),o.index.request({url:u.SERVERTAPI+t.url,method:t.method||"GET",data:t.data||{},timeout:1e5,header:r,success:async e=>{if(e.statusCode===200){if(e.data.code===300||e.data.code===100){await d(),n(e);return}if(e.code===0){i(e.info),n(e);return}a(e.data)}else e.statusCode===401?await d():i(`请求失败，状态码：${e.statusCode}`),n(e)},fail:e=>{i("网络请求失败"),o.index.__f__("log","at request/request.js:81",u.SERVERTAPI+t.url,e),n(e)}})});exports.request=l;
//# sourceMappingURL=../../.sourcemap/mp-weixin/request/request.js.map
