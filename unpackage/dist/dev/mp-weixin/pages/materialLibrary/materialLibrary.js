"use strict";const e=require("../../common/vendor.js"),f=require("../../request/api.js"),T=require("../../store/user.js");require("../../uni_modules/uv-ui-tools/index.js");if(!Array){const p=e.resolveComponent("uv-icon"),r=e.resolveComponent("uv-tabs"),o=e.resolveComponent("tn-empty"),c=e.resolveComponent("tn-icon");(p+r+o+c)()}const I=()=>"../../uni_modules/uv-icon/components/uv-icon/uv-icon.js",P=()=>"../../uni_modules/uv-tabs/components/uv-tabs/uv-tabs.js",F=()=>"../../uni_modules/tuniaoui-vue3/components/empty/src/empty.js",S=()=>"../../uni_modules/tuniaoui-vue3/components/icon/src/icon.js";Math||(I+P+F+S)();const $={__name:"materialLibrary",setup(p){const r=T.useUserStore();e.onLoad(()=>{C(),m()});const o=e.ref(""),c=e.ref([]),g=e.ref(0),v=e.ref([]),u=e.ref(1),_=e.ref(!1),n=e.ref([]),h=()=>{e.index.navigateBack()},x=t=>{g.value=v.value.findIndex(i=>i.id==t.id),u.value=1,n.value=[],b(t.id)},L=t=>{o.value=t,u.value=1,n.value=[],m(t)},y=t=>{e.index.setClipboardData({data:t,success:function(){e.index.showToast({icon:"success",title:"复制成功"})}})},C=()=>{f.topCategory({uid:r.uid,token:r.token}).then(t=>{c.value=t.data,o.value=t.data[0].id,m(t.data[0].id)})},m=t=>{f.childrenCategory({uid:r.uid,token:r.token,cate_id:t}).then(i=>{v.value=i.data,b(i.data[g.value].id),e.index.__f__("log","at pages/materialLibrary/materialLibrary.vue:133",i)})},b=t=>{e.index.showLoading({title:"加载中"}),f.materialListApi({uid:r.uid,token:r.token,cate_id:t,page:u.value}).then(i=>{e.index.hideLoading(),u.value>1?i.data.forEach(a=>{n.value.push(a)}):n.value=i.data,i.data.length==0&&e.index.showToast({icon:"none",title:"暂无更多内容了"}),_.value=!1})},k=()=>{_.value||(_.value=!0,u.value=1,getClassifyGodss())},A=t=>{e.index.downloadFile({url:t.cover,success:function(i){e.index.__f__("log","at pages/materialLibrary/materialLibrary.vue:183",i),e.wx$1.saveImageToPhotosAlbum({filePath:i.tempFilePath,success:function(a){e.index.__f__("log","at pages/materialLibrary/materialLibrary.vue:187",a),e.index.__f__("log","at pages/materialLibrary/materialLibrary.vue:188","success"),e.index.showToast({icon:"success",title:"保存成功"})},fail:function(a){e.index.__f__("log","at pages/materialLibrary/materialLibrary.vue:195",a),e.index.__f__("log","at pages/materialLibrary/materialLibrary.vue:196","fail"),a.errMsg==="saveImageToPhotosAlbum:fail auth deny"&&(e.index.__f__("log","at pages/materialLibrary/materialLibrary.vue:198","打开设置窗口"),e.wx$1.openSetting({success(s){e.index.__f__("log","at pages/materialLibrary/materialLibrary.vue:201",s),s.authSetting["scope.writePhotosAlbum"]?(e.index.showToast({icon:"success",title:"保存成功"}),e.index.__f__("log","at pages/materialLibrary/materialLibrary.vue:208","获取权限成功，再次点击图片保存到相册")):e.index.__f__("log","at pages/materialLibrary/materialLibrary.vue:210","获取权限失败")}}))}})},fail:function(){e.index.__f__("log","at pages/materialLibrary/materialLibrary.vue:219","fail")}})},w=t=>{e.index.previewImage({urls:[t]})};return(t,i)=>e.e({a:e.o(h),b:e.p({name:"arrow-left",color:"#fff"}),c:e.f(c.value,(a,s,l)=>e.e({a:a.id==o.value},a.id==o.value?{}:{},{b:e.t(a.name),c:a.id,d:e.n(a.id==o.value?"select-material-content-left-item":""),e:e.o(d=>L(a.id),a.id)})),d:e.o(x),e:e.p({list:v.value,activeStyle:"color: #FAA82C",lineColor:"#FAA82C"}),f:n.value.length==0},n.value.length==0?{g:e.p({mode:"data"})}:{},{h:n.value.length>0},n.value.length>0?e.e({i:o.value==1},o.value==1?{j:e.f(n.value,(a,s,l)=>({a:"614e150a-3-"+l,b:e.o(d=>A(a)),c:a.cover,d:e.o(d=>w(a.cover))})),k:e.p({name:"download",color:"#FAA82C",size:"50rpx"})}:{},{l:o.value==2},o.value==2?{m:e.f(n.value,(a,s,l)=>({a:e.t(s+1),b:e.t(a.remarks),c:e.o(d=>y(a.remarks)),d:"614e150a-4-"+l})),n:e.p({name:"copy-fill",color:"#FAA82C",size:"60rpx"})}:{},{o:o.value==3},o.value==3?{p:e.f(n.value,(a,s,l)=>({a:e.t(s+1),b:e.t(a.title),c:e.t(a.remarks),d:e.o(d=>y(a.title)),e:"614e150a-5-"+l})),q:e.p({name:"copy-fill",color:"#FAA82C",size:"60rpx"})}:{},{r:e.o(k),s:_.value}):{})}};wx.createPage($);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pages/materialLibrary/materialLibrary.js.map
