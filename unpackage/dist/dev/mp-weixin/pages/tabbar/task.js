"use strict";const e=require("../../common/vendor.js"),g=require("../../common/assets.js"),P=require("../../store/user.js"),d=require("../../request/api.js");if(!Array){const m=e.resolveComponent("uv-line-progress"),c=e.resolveComponent("tn-empty"),a=e.resolveComponent("tn-icon"),n=e.resolveComponent("tn-popup");(m+c+a+n)()}const j=()=>"../../uni_modules/uv-line-progress/components/uv-line-progress/uv-line-progress.js",q=()=>"../../uni_modules/tuniaoui-vue3/components/empty/src/empty.js",F=()=>"../../uni_modules/tuniaoui-vue3/components/icon/src/icon.js",I=()=>"../../uni_modules/tuniaoui-vue3/components/popup/src/popup.js";Math||(j+q+F+I)();const V={__name:"task",setup(m){e.onShow(()=>{a.value=0,T(),x(),C(),b()});const c=e.ref(""),a=e.ref(0),n=P.useUserStore(),i=e.ref(!1),l=e.ref({}),p=e.ref(""),v=e.ref(0),_=e.ref(0),r=e.ref([]),w=()=>{i.value=!0},y=()=>{i.value=!1},h=()=>{e.index.navigateTo({url:"/pages/teachVideo/teachVideo"})},T=()=>{d.taskListApi({uid:n.uid,token:n.token}).then(o=>{const u=o.data.every(s=>s.task_status),t=o.data.some(s=>!s.order_status);u&&t&&(o.data=o.data.map(s=>({...s,order_status:2}))),r.value=o.data,A(o.data)})},x=()=>{d.userInfoApi({uid:n.uid,token:n.token}).then(o=>{l.value=o.data})},k=o=>{if(a.value==0){if(n.token==""){e.index.showModal({title:"请先去登陆吧",success(s){s.confirm&&e.index.navigateTo({url:"/pages/account/login"})}});return}if(a.value=1,l.value.phone==null||l.value.phone==""){e.index.showModal({title:"提示",content:"请完善橱窗信息后再来做任务吧~",confirmText:"前往",cancelText:"取消",success:function(s){s.confirm?e.index.navigateTo({url:"/pages/mineFunc/windowAddress"}):s.cancel&&e.index.__f__("log","at pages/tabbar/task.vue:158","用户点击取消")}});return}const u=[],t=[];if(r.value.forEach(s=>{s.task_status?t.push(s):u.push(s)}),u.length==0){e.index.showToast({icon:"none",title:"该任务已完成"}),a.value=0;return}if(o.id!==u[0].id){t.some(s=>s.window_person_id==o.window_person_id)?(e.index.showToast({icon:"none",title:"该任务已完成"}),a.value=0):(w(),a.value=0);return}n.setTaskVideoCode(o.video_account),n.setOrderNumber(o.order_status?o.window_person_id:o.id),e.index.navigateTo({url:"/pages/task/taskDetail"})}},A=o=>{if(o.length==0)p.value='还差10个任务晋升为"创客"',_.value=0,v.value=0;else{const t=o.filter(f=>f.order_status&&f.order_status===2).length;if(t==10){p.value='您已晋升为"创客"',_.value=t*10,v.value=t;return}const s=10-Number(t);p.value=`还差${s}个任务晋升为"创客"`,_.value=t*10,v.value=t}},C=()=>{d.getTzt().then(o=>{c.value=o.data})},b=()=>{d.userInfoApi({uid:n.uid,token:n.token}).then(o=>{l.value=o.data})};return(o,u)=>e.e({a:g._imports_0$1,b:e.t(p.value),c:e.p({percentage:_.value,activeColor:"#FAA82C",inactiveColor:"#F2F3F8"}),d:g._imports_1$1,e:e.o(h),f:e.t(c.value=="1"?"图文教学":"视频教学"),g:e.o(h),h:r.value.length==0},r.value.length==0?{i:e.p({mode:"data"})}:{},{j:r.value.length>0},r.value.length>0?{k:e.f(r.value,(t,s,f)=>e.e({a:e.t(s<9?"0"+(s+1):s+1),b:e.t(t.window_goods_name),c:t.order_status},t.order_status?{d:e.t(t.order_status==1?"去完成":"已完成")}:{},{e:!t.order_status},t.order_status?{}:{f:e.t(t.task_status?"去完成":"未完成"),g:e.o(S=>k(t))},{h:e.o(S=>k(t))}))}:{},{l:e.p({name:"close-circle",size:"60rpx",color:"#fff"}),m:e.o(y),n:g._imports_2,o:e.o(t=>i.value=t),p:e.p({"open-direction":"center",top:"54px",width:"80%","bg-color":"transparent",modelValue:i.value})})}},$=e._export_sfc(V,[["__scopeId","data-v-00991ab7"]]);wx.createPage($);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pages/tabbar/task.js.map
