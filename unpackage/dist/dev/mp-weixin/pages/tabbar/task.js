"use strict";const e=require("../../common/vendor.js"),v=require("../../common/assets.js"),P=require("../../store/user.js"),f=require("../../request/api.js");if(!Array){const g=e.resolveComponent("uv-line-progress"),c=e.resolveComponent("tn-empty"),a=e.resolveComponent("tn-icon"),n=e.resolveComponent("tn-popup");(g+c+a+n)()}const j=()=>"../../uni_modules/uv-line-progress/components/uv-line-progress/uv-line-progress.js",q=()=>"../../uni_modules/tuniaoui-vue3/components/empty/src/empty.js",S=()=>"../../uni_modules/tuniaoui-vue3/components/icon/src/icon.js",V=()=>"../../uni_modules/tuniaoui-vue3/components/popup/src/popup.js";Math||(j+q+S+V)();const $={__name:"task",setup(g){e.onShow(()=>{n.token==""&&e.index.showModal({title:"请先去登陆吧",success(t){t.confirm&&e.index.navigateTo({url:"/pages/account/login"})}}),a.value=0,C(),T(),A()});const c=e.ref(""),a=e.ref(0),n=P.useUserStore(),l=e.ref(!1),k=e.ref({}),i=e.ref(""),_=e.ref(0),p=e.ref(0),r=e.ref([]),w=()=>{l.value=!0},y=()=>{l.value=!1},m=()=>{e.index.navigateTo({url:"/pages/teachVideo/teachVideo"})},C=()=>{f.taskListApi({uid:n.uid,token:n.token}).then(t=>{r.value=t.data,x(t.data)})},T=()=>{f.userInfoApi({uid:n.uid,token:n.token}).then(t=>{k.value=t.data})},h=t=>{if(a.value==0){a.value=1;const u=[],o=[];if(r.value.forEach(s=>{s.task_status?o.push(s):u.push(s)}),u.length==0){e.index.showToast({icon:"none",title:"该任务已完成"}),a.value=0;return}if(t.id!==u[0].id){o.some(s=>s.window_person_id==t.window_person_id)?(e.index.showToast({icon:"none",title:"该任务已完成"}),a.value=0):(w(),a.value=0);return}n.setTaskVideoCode(t.video_account),n.setOrderNumber(t.order_status?t.window_person_id:t.id),e.index.navigateTo({url:"/pages/task/taskDetail"})}},x=t=>{if(t.length==0)i.value='还差10个任务晋升为"创客"',p.value=0,_.value=0;else{const o=t.filter(d=>d.order_status&&d.order_status===2).length;if(o==10){i.value='您已晋升为"创客"',p.value=o*10,_.value=o;return}const s=10-Number(o);i.value=`还差${s}个任务晋升为"创客"`,p.value=o*10,_.value=o}},A=()=>{f.getTzt().then(t=>{c.value=t.data})};return(t,u)=>e.e({a:v._imports_0$1,b:e.t(i.value),c:e.p({percentage:p.value,activeColor:"#FAA82C",inactiveColor:"#F2F3F8"}),d:v._imports_1$1,e:e.o(m),f:e.t(c.value=="1"?"图文教学":"视频教学"),g:e.o(m),h:r.value.length==0},r.value.length==0?{i:e.p({mode:"data"})}:{},{j:r.value.length>0},r.value.length>0?{k:e.f(r.value,(o,s,d)=>e.e({a:e.t(s<9?"0"+(s+1):s+1),b:e.t(o.window_goods_name),c:o.order_status},o.order_status?{d:e.t(o.order_status==1?"去完成":"已完成")}:{},{e:!o.order_status},o.order_status?{}:{f:e.t(o.task_status?"去完成":"未完成"),g:e.o(b=>h(o))},{h:e.o(b=>h(o))}))}:{},{l:e.p({name:"close-circle",size:"60rpx",color:"#fff"}),m:e.o(y),n:v._imports_2,o:e.o(o=>l.value=o),p:e.p({"open-direction":"center",top:"54px",width:"80%","bg-color":"transparent",modelValue:l.value})})}},F=e._export_sfc($,[["__scopeId","data-v-00991ab7"]]);wx.createPage(F);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pages/tabbar/task.js.map
