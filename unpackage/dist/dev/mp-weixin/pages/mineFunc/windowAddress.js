"use strict";const e=require("../../common/vendor.js"),w=require("../../common/assets.js"),x=require("../../store/user.js"),d=require("../../request/api.js");if(!Array){const r=e.resolveComponent("uv-icon"),n=e.resolveComponent("uv-text"),c=e.resolveComponent("uv-input");(r+n+c)()}const g=()=>"../../uni_modules/uv-icon/components/uv-icon/uv-icon.js",h=()=>"../../uni_modules/uv-text/components/uv-text/uv-text.js",y=()=>"../../uni_modules/uv-input/components/uv-input/uv-input.js";Math||(g+h+y)();const k={__name:"windowAddress",setup(r){const n=e.ref(""),c=e.ref(""),u=e.ref(""),t=e.ref(""),a=x.useUserStore();e.onLoad(()=>{p()});const l=()=>{if(n.value==""||u.value==""||t.value==""){e.index.showToast({icon:"none",title:"请完整填写信息"});return}d.changeUserInfoApi({uid:a.uid,token:a.token,window_goods_name:"蚂蚁联盟-"+n.value,nickname:"蚂蚁联盟-"+n.value,video_account:u.value,phone:t.value}).then(o=>{o.code==1&&(e.index.showToast({icon:"success",title:"修改成功"}),setTimeout(()=>{e.index.navigateBack()},500))})},p=()=>{d.userInfoApi({uid:a.uid,token:a.token}).then(o=>{n.value=o.data.window_goods_name.replace(new RegExp("蚂蚁联盟","g"),""),c.value=o.data.window_qr_code,u.value=o.data.video_account,t.value=o.data.phone})},m=o=>{if(o.detail.errMsg==="getPhoneNumber:ok"){const _=o.detail.encryptedData,s=o.detail.iv;e.index.login({success:i=>{i.code?d.telnumberApi({uid:a.uid,code:i.code,encryptedData:_,iv:s}).then(v=>{e.index.__f__("log","at pages/mineFunc/windowAddress.vue:158",v),t.value=v.data}):(e.index.__f__("error","at pages/mineFunc/windowAddress.vue:163","获取登录凭证失败：",i.errMsg),e.index.showToast({title:"获取登录凭证失败，请稍后重试",icon:"none"}))},fail:i=>{e.index.__f__("error","at pages/mineFunc/windowAddress.vue:172","登录失败：",i),e.index.showToast({title:"登录失败，请检查网络",icon:"none"})}})}else e.index.__f__("log","at pages/mineFunc/windowAddress.vue:181","用户拒绝授权获取手机号"),e.index.showToast({title:"你拒绝了授权，无法获取手机号",icon:"none"})},f=()=>{e.index.navigateBack()};return(o,_)=>({a:w._imports_0$1,b:e.o(f),c:e.p({name:"arrow-left",color:"#fff"}),d:e.p({text:"蚂蚁联盟-",margin:"0 3px 0 0",type:"tips"}),e:e.o(s=>n.value=s),f:e.p({placeholder:"请输入标题",modelValue:n.value}),g:e.o(s=>u.value=s),h:e.p({placeholder:"请输入视频号",modelValue:u.value}),i:e.t(t.value==""?"获取手机号":t.value),j:e.o(m),k:e.o(l)})}},F=e._export_sfc(k,[["__scopeId","data-v-f6ccfdb4"]]);wx.createPage(F);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pages/mineFunc/windowAddress.js.map
